<script>document.write(unescape('%3C!DOCTYPE%20html%3E%0A%3Chtml%20lang%3D%22en%22%3E%0A%3Chead%3E%0A%20%20%20%20%3Cmeta%20charset%3D%22UTF-8%22%3E%0A%20%20%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%20initial-scale%3D1.0%22%3E%0A%20%20%20%20%3Ctitle%3ECalyx%20AI%3C%2Ftitle%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Ffont-awesome%2F6.5.1%2Fcss%2Fall.min.css%22%20integrity%3D%22sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl%2BVegovlnee1c9QX4TctnWMn13TZye%2BgiMm8e2LwA%3D%3D%22%20crossorigin%3D%22anonymous%22%20referrerpolicy%3D%22no-referrer%22%20%2F%3E%0A%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20%20%20%2F*%20---%20Google%20Fonts%20---%20*%2F%0A%20%20%20%20%20%20%20%20%40import%20url(\'https%3A%2F%2Ffonts.googleapis.com%2Fcss2%3Ffamily%3DInter%3Awght%40400%3B500%3B700%26family%3DFira%2BCode%3Awght%40400%3B500%26display%3Dswap\')%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20---%20CSS%20Variables%20for%20Theming%20---%20*%2F%0A%20%20%20%20%20%20%20%20%3Aroot%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20--font-primary%3A%20\'Inter\'%2C%20sans-serif%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--font-code%3A%20\'Fira%20Code\'%2C%20monospace%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--base-font-size%3A%2016px%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F*%20Light%20Theme%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20--bg-color%3A%20%23f0f2f5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--header-bg%3A%20rgba(255%2C%20255%2C%20255%2C%200.7)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--chatbox-bg%3A%20%23ffffff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--user-msg-bg-custom%3A%20%230084ff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--user-msg-color%3A%20%23ffffff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--ai-msg-bg%3A%20%23e4e6eb%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--ai-msg-color%3A%20%230d0d0d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--form-bg%3A%20rgba(255%2C%20255%2C%20255%2C%200.7)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--input-bg%3A%20%23f0f2f5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--text-color%3A%20%23050505%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--border-color%3A%20%23ced0d4%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--shadow-color%3A%20rgba(0%2C%200%2C%200%2C%200.1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--icon-color%3A%20%2365676b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--timestamp-color%3A%20%2365676b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-bg%3A%20%23f5f5f5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-text-color%3A%20%232d2d2d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-border-color%3A%20%23ddd%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--welcome-text-color%3A%20%2365676b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--modal-bg%3A%20rgba(255%2C%20255%2C%20255%2C%200.85)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--success-bg%3A%20%23d4edda%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--success-color%3A%20%23155724%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--error-bg%3A%20%23f8d7da%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--error-color%3A%20%23721c24%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-bg%3A%20%23f8f9fa%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-border%3A%20%23e9ecef%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-text%3A%20%23343a40%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-hover-bg%3A%20%23e9ecef%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-active-bg%3A%20%23dee2e6%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20body.dark-mode%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F*%20Dark%20Theme%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20--bg-color%3A%20%2318191a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--header-bg%3A%20rgba(36%2C%2037%2C%2038%2C%200.7)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--chatbox-bg%3A%20%2318191a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--ai-msg-bg%3A%20%233a3b3c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--ai-msg-color%3A%20%23e4e6eb%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--form-bg%3A%20rgba(36%2C%2037%2C%2038%2C%200.7)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--input-bg%3A%20%233a3b3c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--text-color%3A%20%23e4e6eb%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--border-color%3A%20%233e4042%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--shadow-color%3A%20rgba(0%2C%200%2C%200%2C%200.2)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--icon-color%3A%20%23b0b3b8%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--timestamp-color%3A%20%23b0b3b8%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-bg%3A%20%231e1e1e%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-text-color%3A%20%23d4d4d4%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--code-border-color%3A%20%23444%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--welcome-text-color%3A%20%23b0b3b8%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--modal-bg%3A%20rgba(36%2C%2037%2C%2038%2C%200.85)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--success-bg%3A%20%231a3b2a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--success-color%3A%20%23a7e3b4%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--error-bg%3A%20%234d2a2a%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--error-color%3A%20%23ffbaba%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-bg%3A%20%23242526%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-border%3A%20%233e4042%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-text%3A%20%23e4e6eb%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-hover-bg%3A%20%233a3b3c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20--sidebar-active-bg%3A%20%23525355%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20---%20General%20%26%20Animation%20Styles%20---%20*%2F%0A%20%20%20%20%20%20%20%20*%20%7B%20box-sizing%3A%20border-box%3B%20margin%3A%200%3B%20padding%3A%200%3B%20%7D%0A%20%20%20%20%20%20%20%20html%20%7B%20font-size%3A%20var(--base-font-size)%3B%20%7D%0A%20%20%20%20%20%20%20%20body%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20var(--font-primary)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--bg-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100vh%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.3s%2C%20color%200.3s%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20Particle%20Background%20*%2F%0A%20%20%20%20%20%20%20%20%23particle-canvas%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20absolute%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20top%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20left%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20z-index%3A%20-1%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%40keyframes%20fadeIn%20%7B%20from%20%7B%20opacity%3A%200%3B%20transform%3A%20translateY(10px)%3B%20%7D%20to%20%7B%20opacity%3A%201%3B%20transform%3A%20translateY(0)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20messageSlideIn%20%7B%20from%20%7B%20opacity%3A%200%3B%20transform%3A%20translateY(20px)%20scale(0.98)%3B%20%7D%20to%20%7B%20opacity%3A%201%3B%20transform%3A%20translateY(0)%20scale(1)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20modalFadeIn%20%7B%20from%20%7B%20opacity%3A%200%3B%20%7D%20to%20%7B%20opacity%3A%201%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20send-animation%20%7B%200%25%20%7B%20transform%3A%20scale(1)%3B%20%7D%2050%25%20%7B%20transform%3A%20scale(0.8)%20rotate(-15deg)%3B%20%7D%20100%25%20%7B%20transform%3A%20scale(1)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20.send-btn-animated%20%7B%20animation%3A%20send-animation%200.5s%20ease-in-out%3B%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20pulse%20%7B%200%25%20%7B%20opacity%3A%200.7%3B%20transform%3A%20scale(1)%3B%20%7D%2050%25%20%7B%20opacity%3A%201%3B%20transform%3A%20scale(1.1)%3B%20%7D%20100%25%20%7B%20opacity%3A%200.7%3B%20transform%3A%20scale(1)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20shake%20%7B%2010%25%2C%2090%25%20%7B%20transform%3A%20translate3d(-1px%2C%200%2C%200)%3B%20%7D%2020%25%2C%2080%25%20%7B%20transform%3A%20translate3d(2px%2C%200%2C%200)%3B%20%7D%2030%25%2C%2050%25%2C%2070%25%20%7B%20transform%3A%20translate3d(-4px%2C%200%2C%200)%3B%20%7D%2040%25%2C%2060%25%20%7B%20transform%3A%20translate3d(4px%2C%200%2C%200)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20spin%20%7B%20to%20%7B%20transform%3A%20rotate(360deg)%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20halo-glow%20%7B%200%25%20%7B%20box-shadow%3A%200%200%208px%202px%20rgba(0%2C%20132%2C%20255%2C%200.3)%3B%20%7D%2050%25%20%7B%20box-shadow%3A%200%200%2016px%206px%20rgba(0%2C%20132%2C%20255%2C%200.6)%3B%20%7D%20100%25%20%7B%20box-shadow%3A%200%200%208px%202px%20rgba(0%2C%20132%2C%20255%2C%200.3)%3B%20%7D%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20---%20Authentication%20Screen%20Styles%20---%20*%2F%0A%20%20%20%20%20%20%20%20%23auth-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20max-width%3A%20400px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%202rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--header-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20rgba(255%2C%20255%2C%20255%2C%200.1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2012px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%204px%2020px%20var(--shadow-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20animation%3A%20fadeIn%200.5s%20ease-out%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-form-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20opacity%200.3s%20ease%2C%20transform%200.3s%20ease%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-form-container.hidden%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20scale(0.95)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20absolute%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20top%3A%202rem%3B%20left%3A%202rem%3B%20right%3A%202rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pointer-events%3A%20none%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23auth-container%20h2%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom%3A%201.5rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-input-group%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-input-group%20label%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20block%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom%3A%205px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.9rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-input-group%20input%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2012px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--input-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20border-color%200.2s%2C%20box-shadow%200.2s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-input-group%20input%3Afocus%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20outline%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-color%3A%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%200%200%202px%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-submit-btn%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2012px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--user-msg-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20opacity%200.2s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-submit-btn%3Ahover%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200.9%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-toggle-link%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-top%3A%201.5rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.9rem%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.auth-toggle-link%20span%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23auth-error-message%2C%20%23register-error-message%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--error-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--error-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2010px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.9rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20none%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23auth-error-message.show%2C%20%23register-error-message.show%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20block%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20animation%3A%20shake%200.5s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23auth-loading-overlay%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20absolute%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20top%3A%200%3B%20left%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20rgba(0%2C%200%2C%200%2C%200.5)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20backdrop-filter%3A%20blur(4px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-direction%3A%20column%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20white%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20z-index%3A%2010%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23auth-loading-overlay%20.spinner%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%204px%20solid%20rgba(255%2C%20255%2C%20255%2C%200.3)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-top-color%3A%20%23fff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2050%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20animation%3A%20spin%201s%20linear%20infinite%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20---%20Main%20App%20Container%20---%20*%2F%0A%20%20%20%20%20%20%20%20%23app-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.chat-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20max-width%3A%20800px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2095vh%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--chatbox-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2012px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%204px%2020px%20var(--shadow-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.3s%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-direction%3A%20column%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20---%20Header%20---%20*%2F%0A%20%20%20%20%20%20%20%20.chat-header%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20space-between%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%200.75rem%201.25rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--header-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%201px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.3s%2C%20border-bottom%200.3s%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-shrink%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20z-index%3A%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.chat-header%20h1%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201.3rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20700%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3A%200%20auto%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20letter-spacing%3A%201px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%20%2F*%20FIX%3A%20Added%20solid%20text%20color%20as%20fallback%20*%2F%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F*%20FIX%3A%20Removed%20problematic%20text-fill-color%20properties%20*%2F%0A%20%20%20%20%20%20%20%20body%3Anot(.dark-mode)%20.chat-header%20h1%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20linear-gradient(90deg%2C%20%23050505%2C%20%2365676b)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-background-clip%3A%20text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-clip%3A%20text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-text-fill-color%3A%20transparent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20transparent%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20body.dark-mode%20.chat-header%20h1%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20linear-gradient(90deg%2C%20%23e4e6eb%2C%20%23b0b3b8)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-background-clip%3A%20text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-clip%3A%20text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-text-fill-color%3A%20transparent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20transparent%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20.header-controls%20%7B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20gap%3A%201rem%3B%20position%3A%20absolute%3B%20right%3A%201.25rem%3B%20%7D%0A%20%20%20%20%20%20%20%20%23toggle-sidebar-btn%20%7B%20position%3A%20absolute%3B%20left%3A%201.25rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.header-icon%20%7B%20background%3A%20none%3B%20border%3A%20none%3B%20cursor%3A%20pointer%3B%20color%3A%20var(--icon-color)%3B%20font-size%3A%201.4rem%3B%20padding%3A%205px%3B%20width%3A%2032px%3B%20height%3A%2032px%3B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20transition%3A%20color%200.2s%2C%20transform%200.2s%3B%20border-radius%3A%2050%25%3B%20%7D%0A%20%20%20%20%20%20%20%20.header-icon%3Ahover%20%7B%20color%3A%20var(--user-msg-bg-custom)%3B%20transform%3A%20scale(1.1)%3B%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20---%20Theme%20Toggle%20---%20*%2F%0A%20%20%20%20%20%20%20%20.theme-switch%20%7B%20position%3A%20relative%3B%20display%3A%20inline-block%3B%20width%3A%2048px%3B%20height%3A%2024px%3B%20%7D%0A%20%20%20%20%20%20%20%20.theme-switch%20input%20%7B%20opacity%3A%200%3B%20width%3A%200%3B%20height%3A%200%3B%20%7D%0A%20%20%20%20%20%20%20%20.slider%20%7B%20position%3A%20absolute%3B%20cursor%3A%20pointer%3B%20top%3A%200%3B%20left%3A%200%3B%20right%3A%200%3B%20bottom%3A%200%3B%20background-color%3A%20%23ccc%3B%20transition%3A%20.4s%3B%20border-radius%3A%2024px%3B%20%7D%0A%20%20%20%20%20%20%20%20.slider%3Abefore%20%7B%20position%3A%20absolute%3B%20content%3A%20%22%22%3B%20height%3A%2018px%3B%20width%3A%2018px%3B%20left%3A%204px%3B%20bottom%3A%203px%3B%20background-color%3A%20white%3B%20transition%3A%20.4s%3B%20border-radius%3A%2050%25%3B%20%7D%0A%20%20%20%20%20%20%20%20input%3Achecked%20%2B%20.slider%20%7B%20background-color%3A%20var(--user-msg-bg-custom)%3B%20%7D%0A%20%20%20%20%20%20%20%20input%3Achecked%20%2B%20.slider%3Abefore%20%7B%20transform%3A%20translateX(22px)%3B%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20---%20Chat%20Box%20%26%20Messages%20---%20*%2F%0A%20%20%20%20%20%20%20%20%23chat-box%20%7B%20flex-grow%3A%201%3B%20overflow-y%3A%20auto%3B%20padding%3A%201.25rem%3B%20display%3A%20flex%3B%20flex-direction%3A%20column%3B%20gap%3A%201rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.message%20%7B%20display%3A%20flex%3B%20align-items%3A%20flex-start%3B%20gap%3A%2012px%3B%20max-width%3A%2090%25%3B%20animation%3A%20messageSlideIn%200.4s%20ease-out%3B%20%7D%0A%20%20%20%20%20%20%20%20.avatar%20%7B%20width%3A%2040px%3B%20height%3A%2040px%3B%20border-radius%3A%2050%25%3B%20object-fit%3A%20cover%3B%20flex-shrink%3A%200%3B%20%7D%0A%20%20%20%20%20%20%20%20.message-content%20%7B%20padding%3A%200.75rem%201rem%3B%20border-radius%3A%2018px%3B%20position%3A%20relative%3B%20word-wrap%3A%20break-word%3B%20display%3A%20flex%3B%20flex-direction%3A%20column%3B%20max-width%3A%20100%25%3B%20overflow%3A%20hidden%3B%20box-shadow%3A%200%201px%203px%20var(--shadow-color)%3B%20%7D%0A%20%20%20%20%20%20%20%20.message.user-message%20%7B%20align-self%3A%20flex-end%3B%20flex-direction%3A%20row-reverse%3B%20%7D%0A%20%20%20%20%20%20%20%20.user-message%20.message-content%20%7B%20background-color%3A%20var(--user-msg-bg-custom)%3B%20color%3A%20var(--user-msg-color)%3B%20border-bottom-right-radius%3A%204px%3B%20%7D%0A%20%20%20%20%20%20%20%20.message.ai-message%20%7B%20align-self%3A%20flex-start%3B%20min-width%3A%2070%25%3B%20%7D%0A%20%20%20%20%20%20%20%20.ai-message%20.message-content%20%7B%20background-color%3A%20var(--ai-msg-bg)%3B%20color%3A%20var(--ai-msg-color)%3B%20border-bottom-left-radius%3A%204px%3B%20%7D%0A%20%20%20%20%20%20%20%20.timestamp%20%7B%20font-size%3A%200.7rem%3B%20color%3A%20var(--timestamp-color)%3B%20margin-top%3A%205px%3B%20align-self%3A%20flex-end%3B%20opacity%3A%200.8%3B%20%7D%0A%20%20%20%20%20%20%20%20.user-message%20.timestamp%20%7B%20color%3A%20rgba(255%2C%20255%2C%20255%2C%200.7)%3B%20%7D%0A%20%20%20%20%20%20%20%20.message.error-message%20.message-content%20%7B%20background-color%3A%20var(--error-bg)%3B%20color%3A%20var(--error-color)%3B%20border%3A%201px%20solid%20var(--error-color)%3B%20%7D%0A%20%20%20%20%20%20%20%20.error-text%3A%3Abefore%20%7B%20content%3A%20\'%E2%9A%A0%EF%B8%8F%20\'%3B%20font-weight%3A%20bold%3B%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%23welcome-container%20%7B%20text-align%3A%20center%3B%20padding%3A%2040px%2020px%3B%20margin%3A%20auto%3B%20color%3A%20var(--welcome-text-color)%3B%20%7D%0A%20%20%20%20%20%20%20%20%23welcome-container%20.avatar%20%7B%20width%3A%2060px%3B%20height%3A%2060px%3B%20margin-bottom%3A%2010px%3B%20animation%3A%20halo-glow%203s%20ease-in-out%20infinite%3B%20%7D%0A%20%20%20%20%20%20%20%20%23welcome-container%20h2%20%7B%20font-size%3A%201.8rem%3B%20margin-bottom%3A%2010px%3B%20font-weight%3A%20700%3B%20background%3A%20linear-gradient(45deg%2C%20var(--user-msg-bg-custom)%2C%20var(--text-color))%3B%20-webkit-background-clip%3A%20text%3B%20-webkit-text-fill-color%3A%20transparent%3B%20background-clip%3A%20text%3B%20text-fill-color%3A%20transparent%3B%20%7D%0A%20%20%20%20%20%20%20%20%23welcome-container%20p%20%7B%20font-size%3A%200.9rem%3B%20margin-bottom%3A%2020px%3B%20%7D%0A%20%20%20%20%20%20%20%20.example-prompts%20%7B%20display%3A%20flex%3B%20flex-wrap%3A%20wrap%3B%20justify-content%3A%20center%3B%20gap%3A%2010px%3B%20%7D%0A%20%20%20%20%20%20%20%20.example-prompt%20%7B%20background%3A%20var(--ai-msg-bg)%3B%20border%3A%201px%20solid%20var(--border-color)%3B%20color%3A%20var(--text-color)%3B%20padding%3A%2010px%2015px%3B%20border-radius%3A%2020px%3B%20font-size%3A%200.85rem%3B%20cursor%3A%20pointer%3B%20transition%3A%20all%200.2s%20ease%3B%20%7D%0A%20%20%20%20%20%20%20%20.example-prompt%3Ahover%20%7B%20background%3A%20var(--input-bg)%3B%20border-color%3A%20var(--user-msg-bg-custom)%3B%20transform%3A%20translateY(-2px)%3B%20box-shadow%3A%200%204px%208px%20var(--shadow-color)%3B%20%7D%0A%0A%20%20%20%20%20%20%20%20.loading-dots%20span%20%7B%20display%3A%20inline-block%3B%20width%3A%208px%3B%20height%3A%208px%3B%20border-radius%3A%2050%25%3B%20background%3A%20currentColor%3B%20margin%3A%200%202px%3B%20animation%3A%20blink%201.4s%20infinite%20both%3B%20%7D%0A%20%20%20%20%20%20%20%20.loading-dots%20span%3Anth-child(2)%20%7B%20animation-delay%3A%200.2s%3B%20%7D%0A%20%20%20%20%20%20%20%20.loading-dots%20span%3Anth-child(3)%20%7B%20animation-delay%3A%200.4s%3B%20%7D%0A%20%20%20%20%20%20%20%20%40keyframes%20blink%20%7B%200%25%20%7B%20opacity%3A%200.2%3B%20%7D%2020%25%20%7B%20opacity%3A%201%3B%20%7D%20100%25%20%7B%20opacity%3A%200.2%3B%20%7D%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20---%20Styles%20for%20Code%20Block%20with%20Preview%20---%20*%2F%0A%20%20%20%20%20%20%20%20.code-block-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--code-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var(--code-border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3A%2010px%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overflow%3A%20hidden%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.3s%2C%20border%200.3s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-header%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20rgba(0%2C0%2C0%2C0.05)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%204px%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%201px%20solid%20var(--code-border-color)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20body.dark-mode%20.code-block-header%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20rgba(255%2C255%2C255%2C0.05)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-tab-btn%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%206px%2012px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.85rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200.7%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%202px%20solid%20transparent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20opacity%200.2s%2C%20border-color%200.2s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-tab-btn%3Ahover%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-tab-btn.active%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-bottom%3A%202px%20solid%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-header%20.copy-code-btn%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-left%3A%20auto%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--input-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%204px%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%205px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.8rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.2s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-header%20.copy-code-btn%3Ahover%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--user-msg-color)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-header%20.copy-code-btn.copied%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%2328a745%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20white%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-content%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-content%20pre%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%200%200%208px%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.9rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20white-space%3A%20pre-wrap%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20word-wrap%3A%20break-word%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--code-text-color)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.code-block-content%20iframe%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20400px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%23ffffff%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20none%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20Improved%20Input%20Area%20Layout%20*%2F%0A%20%20%20%20%20%20%20%20%23chat-form%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-direction%3A%20column%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%201rem%201.25rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-top%3A%201px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--form-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20background-color%200.3s%2C%20border-top%200.3s%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-shrink%3A%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20.input-container%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20flex-end%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gap%3A%208px%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23chat-input%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-grow%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2012px%2015px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2024px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--input-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resize%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20max-height%3A%20150px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20white-space%3A%20pre-wrap%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20min-height%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20line-height%3A%201.4%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23chat-input%3Afocus%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20outline%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%200%200%202px%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20.form-buttons%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20Improved%20Send%20Button%20*%2F%0A%20%20%20%20%20%20%20%20%23send-btn%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20white%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2050%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20scale(0.7)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pointer-events%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20all%200.2s%20ease-out%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23send-btn.active%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20scale(1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pointer-events%3A%20auto%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23send-btn%3Ahover%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20scale(1.1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%200%2010px%20rgba(0%2C%20132%2C%20255%2C%200.5)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23send-btn%3Adisabled%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--icon-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200.7%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%20none%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%23scroll-to-bottom-btn%20%7B%20position%3A%20absolute%3B%20bottom%3A%20100px%3B%20right%3A%2025px%3B%20background-color%3A%20var(--ai-msg-bg)%3B%20color%3A%20var(--ai-msg-color)%3B%20border%3A%201px%20solid%20var(--border-color)%3B%20border-radius%3A%2050%25%3B%20width%3A%2040px%3B%20height%3A%2040px%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20cursor%3A%20pointer%3B%20box-shadow%3A%200%202px%2010px%20var(--shadow-color)%3B%20opacity%3A%200%3B%20visibility%3A%20hidden%3B%20transform%3A%20translateY(20px)%3B%20transition%3A%20opacity%200.3s%20ease%2C%20visibility%200.3s%20ease%2C%20transform%200.3s%20ease%3B%20z-index%3A%20100%3B%20pointer-events%3A%20none%3B%20%7D%0A%20%20%20%20%20%20%20%20%23scroll-to-bottom-btn.show%20%7B%20opacity%3A%201%3B%20visibility%3A%20visible%3B%20transform%3A%20translateY(0)%3B%20pointer-events%3A%20auto%3B%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%23chat-history-sidebar%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20fixed%3B%20top%3A%200%3B%20left%3A%200%3B%20width%3A%20280px%3B%20height%3A%20100%25%3B%20background-color%3A%20var(--sidebar-bg)%3B%20box-shadow%3A%202px%200%2010px%20rgba(0%2C0%2C0%2C0.1)%3B%20display%3A%20flex%3B%20flex-direction%3A%20column%3B%20padding%3A%201rem%3B%20z-index%3A%201002%3B%20transform%3A%20translateX(-100%25)%3B%20transition%3A%20transform%200.4s%20ease-in-out%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20body.sidebar-open%20%23chat-history-sidebar%20%7B%20transform%3A%20translateX(0)%3B%20%7D%0A%20%20%20%20%20%20%20%20.sidebar-header%20%7B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20space-between%3B%20padding-bottom%3A%201rem%3B%20border-bottom%3A%201px%20solid%20var(--sidebar-border)%3B%20%7D%0A%20%20%20%20%20%20%20%20.sidebar-header%20h2%20%7B%20font-size%3A%201.1rem%3B%20color%3A%20var(--sidebar-text)%3B%20%7D%0A%20%20%20%20%20%20%20%20%23new-chat-btn%20%7B%20background%3A%20var(--user-msg-bg-custom)%3B%20color%3A%20var(--user-msg-color)%3B%20border%3A%20none%3B%20padding%3A%208px%2012px%3B%20border-radius%3A%206px%3B%20cursor%3A%20pointer%3B%20font-size%3A%200.9rem%3B%20font-weight%3A%20500%3B%20transition%3A%20opacity%200.2s%3B%20%7D%0A%20%20%20%20%20%20%20%20%23new-chat-btn%3Ahover%20%7B%20opacity%3A%200.9%3B%20%7D%0A%20%20%20%20%20%20%20%20%23chat-list%20%7B%20list-style%3A%20none%3B%20padding%3A%200%3B%20margin%3A%200%3B%20overflow-y%3A%20auto%3B%20flex-grow%3A%201%3B%20margin-top%3A%201rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.chat-list-item%20%7B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20space-between%3B%20padding%3A%2012px%2010px%3B%20border-radius%3A%208px%3B%20margin-bottom%3A%208px%3B%20cursor%3A%20pointer%3B%20color%3A%20var(--sidebar-text)%3B%20transition%3A%20background-color%200.2s%3B%20%7D%0A%20%20%20%20%20%20%20%20.chat-list-item%3Ahover%20%7B%20background-color%3A%20var(--sidebar-hover-bg)%3B%20%7D%0A%20%20%20%20%20%20%20%20.chat-list-item.active%20%7B%20background-color%3A%20var(--sidebar-active-bg)%3B%20font-weight%3A%20500%3B%20%7D%0A%20%20%20%20%20%20%20%20.chat-list-item%20span%20%7B%20white-space%3A%20nowrap%3B%20overflow%3A%20hidden%3B%20text-overflow%3A%20ellipsis%3B%20flex-grow%3A%201%3B%20%7D%0A%20%20%20%20%20%20%20%20.delete-chat-btn%20%7B%20background%3A%20none%3B%20border%3A%20none%3B%20color%3A%20var(--icon-color)%3B%20cursor%3A%20pointer%3B%20font-size%3A%201rem%3B%20opacity%3A%200.5%3B%20transition%3A%20opacity%200.2s%2C%20color%200.2s%3B%20padding%3A%205px%3B%20margin-left%3A%2010px%3B%20visibility%3A%20hidden%3B%20%7D%0A%20%20%20%20%20%20%20%20.chat-list-item%3Ahover%20.delete-chat-btn%20%7B%20visibility%3A%20visible%3B%20%7D%0A%20%20%20%20%20%20%20%20.delete-chat-btn%3Ahover%20%7B%20opacity%3A%201%3B%20color%3A%20%23ff4d4d%3B%20%7D%0A%0A%20%20%20%20%20%20%20%20%23sidebar-overlay%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20fixed%3B%20top%3A%200%3B%20left%3A%200%3B%20width%3A%20100%25%3B%20height%3A%20100%25%3B%20background-color%3A%20rgba(0%2C0%2C0%2C0.5)%3B%20z-index%3A%201001%3B%20opacity%3A%200%3B%20visibility%3A%20hidden%3B%20transition%3A%20opacity%200.4s%20ease%2C%20visibility%200.4s%20ease%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20body.sidebar-open%20%23sidebar-overlay%20%7B%20opacity%3A%201%3B%20visibility%3A%20visible%3B%20%7D%0A%0A%20%20%20%20%20%20%20%20.modal%20%7B%20position%3A%20fixed%3B%20top%3A%200%3B%20left%3A%200%3B%20width%3A%20100%25%3B%20height%3A%20100%25%3B%20background-color%3A%20rgba(0%2C0%2C0%2C0.6)%3B%20display%3A%20none%3B%20justify-content%3A%20center%3B%20align-items%3A%20center%3B%20z-index%3A%201010%3B%20animation%3A%20modalFadeIn%200.3s%20ease%3B%20%7D%0A%20%20%20%20%20%20%20%20.modal-content%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--modal-bg)%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20-webkit-backdrop-filter%3A%20blur(10px)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%202rem%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2012px%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%205px%2015px%20rgba(0%2C0%2C0%2C0.3)%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2090%25%3B%20max-width%3A%20450px%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20animation%3A%20fadeIn%200.3s%20ease%3B%20%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23settings-modal%20.settings-content%20%7B%20display%3A%20flex%3B%20flex-direction%3A%20column%3B%20gap%3A%201.5rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.settings-content%20h2%20%7B%20text-align%3A%20center%3B%20margin-bottom%3A%200.5rem%3B%20%7D%0A%20%20%20%20%20%20%20%20%23close-settings%20%7B%20position%3A%20absolute%3B%20top%3A%2010px%3B%20right%3A%2015px%3B%20font-size%3A%201.5rem%3B%20cursor%3A%20pointer%3B%20border%3A%20none%3B%20background%3A%20none%3B%20color%3A%20var(--icon-color)%3B%20width%3A%2032px%3B%20height%3A%2032px%3B%20display%3Aflex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%7D%0A%20%20%20%20%20%20%20%20.settings-section%20%7B%20border-top%3A%201px%20solid%20var(--border-color)%3B%20padding-top%3A%201.5rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.setting%20%7B%20display%3A%20flex%3B%20justify-content%3A%20space-between%3B%20align-items%3A%20center%3B%20margin-bottom%3A%201rem%3B%20%7D%0A%20%20%20%20%20%20%20%20.setting%20label%20%7B%20font-weight%3A%20500%3B%20%7D%0A%20%20%20%20%20%20%20%20.font-size-controls%20button%20%7B%20width%3A%2030px%3B%20height%3A%2030px%3B%20border%3A%201px%20solid%20var(--border-color)%3B%20background%3A%20var(--input-bg)%3B%20cursor%3A%20pointer%3B%20border-radius%3A%2050%25%3B%20font-size%3A%201rem%3B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20%7D%0A%20%20%20%20%20%20%20%20%23current-font-size%20%7B%20margin%3A%200%2010px%3B%20%7D%0A%20%20%20%20%20%20%20%20%23avatar-upload-label%20%7B%20cursor%3A%20pointer%3B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20gap%3A%2010px%3B%20%7D%0A%20%20%20%20%20%20%20%20%23avatar-preview%20%7B%20width%3A%2040px%3B%20height%3A%2040px%3B%20border-radius%3A%2050%25%3B%20object-fit%3A%20cover%3B%20border%3A%202px%20solid%20var(--border-color)%3B%20%7D%0A%20%20%20%20%20%20%20%20%23avatar-upload%20%7B%20display%3A%20none%3B%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F*%20---%20Cool%20Animated%20Color%20Picker%20Styles%20---%20*%2F%0A%20%20%20%20%20%20%20%20.custom-color-picker-wrapper%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2040px%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23custom-color-preview%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%2050%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%202px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20transform%200.2s%20ease%2C%20box-shadow%200.2s%20ease%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201.2rem%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.custom-color-picker-wrapper%3Ahover%20%23custom-color-preview%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20transform%3A%20scale(1.15)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20box-shadow%3A%200%200%2012px%20var(--user-msg-bg-custom)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%23chat-color-picker%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20absolute%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20top%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20left%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20opacity%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%23save-settings-btn%2C%20%23logout-btn%20%7B%20background-color%3A%20var(--user-msg-bg-custom)%3B%20color%3A%20white%3B%20border%3A%20none%3B%20padding%3A%2012px%3B%20border-radius%3A%208px%3B%20font-size%3A%201rem%3B%20cursor%3A%20pointer%3B%20transition%3A%20opacity%200.2s%3B%20width%3A%20100%25%3B%20%7D%0A%20%20%20%20%20%20%20%20%23save-settings-btn%3Ahover%2C%20%23logout-btn%3Ahover%20%7B%20opacity%3A%200.9%3B%20%7D%0A%20%20%20%20%20%20%20%20%23logout-btn%20%7B%20background-color%3A%20%23e74c3c%3B%20margin-top%3A%20-1rem%3B%20%2F*%20Adjust%20spacing%20*%2F%7D%0A%0A%20%20%20%20%20%20%20%20.modal-content%20p%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3A%201rem%200%201.5rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20line-height%3A%201.5%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-actions%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20justify-content%3A%20flex-end%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gap%3A%201rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-top%3A%201.5rem%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-btn%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%2010px%2020px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-weight%3A%20500%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%200.9rem%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20transition%3A%20opacity%200.2s%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-btn%3Ahover%20%7B%20opacity%3A%200.85%3B%20%7D%0A%20%20%20%20%20%20%20%20.modal-btn-secondary%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20var(--ai-msg-bg)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20var(--text-color)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20var(--border-color)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-btn-danger%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%23e74c3c%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20%23ffffff%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%23notification-bar%20%7B%20position%3A%20absolute%3B%20top%3A%20-50px%3B%20left%3A%2050%25%3B%20transform%3A%20translateX(-50%25)%3B%20background-color%3A%20var(--success-bg)%3B%20color%3A%20var(--success-color)%3B%20padding%3A%2010px%2020px%3B%20border-radius%3A%2020px%3B%20font-size%3A%200.9rem%3B%20z-index%3A%201000%3B%20transition%3A%20top%200.5s%20ease-in-out%3B%20%7D%0A%20%20%20%20%20%20%20%20%23notification-bar.show%20%7B%20top%3A%2015px%3B%20%7D%0A%0A%20%20%20%20%20%20%20%20%40media%20(max-width%3A%20600px)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20body%20%7B%20align-items%3A%20center%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%23app-container%20%7B%20align-items%3A%20flex-start%3B%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20.chat-container%20%7B%20height%3A%20calc(var(--vh%2C%201vh)%20*%20100)%3B%20border-radius%3A%200%3B%20max-width%3A%20100%25%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%23chat-box%20%7B%20padding%3A%201rem%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20.message%20%7B%20max-width%3A%2095%25%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20.ai-message%20%7B%20min-width%3A%2080%25%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%23chat-form%20%7B%20padding%3A%200.75rem%201rem%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%23chat-history-sidebar%20%7B%20border-radius%3A%200%3B%20%7D%20%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2Fstyle%3E%0A%3C%2Fhead%3E%0A%3Cbody%20class%3D%22%22%3E%0A%0A%20%20%20%20%3C!--%20Particle%20Background%20Canvas%20--%3E%0A%20%20%20%20%3Ccanvas%20id%3D%22particle-canvas%22%3E%3C%2Fcanvas%3E%0A%0A%20%20%20%20%3C!--%20Authentication%20Container%20--%3E%0A%20%20%20%20%3Cdiv%20id%3D%22auth-container%22%3E%0A%20%20%20%20%20%20%20%20%3C!--%20Login%20Form%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22login-form%22%20class%3D%22auth-form-container%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cform%20id%3D%22login-form-element%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3ELogin%20to%20Calyx%20AI%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22auth-error-message%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22auth-input-group%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22login-email%22%3EEmail%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22email%22%20id%3D%22login-email%22%20required%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22auth-input-group%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22login-password%22%3EPassword%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22password%22%20id%3D%22login-password%22%20required%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20type%3D%22submit%22%20class%3D%22auth-submit-btn%22%3ELogin%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fform%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20class%3D%22auth-toggle-link%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Don\'t%20have%20an%20account%3F%20%3Cspan%20data-auth-action%3D%22showRegister%22%3ESign%20up%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fp%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%20%20%20%20%3C!--%20Registration%20Form%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22register-form%22%20class%3D%22auth-form-container%20hidden%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cform%20id%3D%22register-form-element%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3ECreate%20Account%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22register-error-message%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22auth-input-group%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22register-username%22%3EUsername%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22text%22%20id%3D%22register-username%22%20required%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22auth-input-group%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22register-email%22%3EEmail%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22email%22%20id%3D%22register-email%22%20required%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22auth-input-group%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22register-password%22%3EPassword%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22password%22%20id%3D%22register-password%22%20required%20minlength%3D%226%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20type%3D%22submit%22%20class%3D%22auth-submit-btn%22%3ESign%20Up%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fform%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20class%3D%22auth-toggle-link%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Already%20have%20an%20account%3F%20%3Cspan%20data-auth-action%3D%22showLogin%22%3ELog%20in%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fp%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%20%20%20%20%3C!--%20Loading%20Overlay%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22auth-loading-overlay%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22spinner%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%3ERedirecting...%3C%2Fp%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%3C!--%20Main%20App%20Container%20--%3E%0A%20%20%20%20%3Cdiv%20id%3D%22app-container%22%3E%0A%20%20%20%20%20%20%20%20%3C!--%20Sidebar%20for%20Chat%20History%20--%3E%0A%20%20%20%20%20%20%20%20%3Caside%20id%3D%22chat-history-sidebar%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22sidebar-header%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3EHistory%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22new-chat-btn%22%3ENew%20Chat%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cul%20id%3D%22chat-list%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C!--%20Chat%20items%20will%20be%20dynamically%20inserted%20here%20--%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Ful%3E%0A%20%20%20%20%20%20%20%20%3C%2Faside%3E%0A%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22sidebar-overlay%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22chat-container%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22notification-bar%22%3ENotification%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cheader%20class%3D%22chat-header%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22toggle-sidebar-btn%22%20class%3D%22header-icon%22%20title%3D%22Toggle%20History%22%20aria-label%3D%22Toggle%20chat%20history%20sidebar%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%22fa-solid%20fa-bars%22%3E%3C%2Fi%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch1%3ECalyx%20AI%3C%2Fh1%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22header-controls%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22settings-btn%22%20class%3D%22header-icon%22%20title%3D%22Settings%22%20aria-label%3D%22Open%20settings%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%22fa-solid%20fa-gear%22%3E%3C%2Fi%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20class%3D%22theme-switch%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22checkbox%22%20id%3D%22theme-checkbox%22%20aria-label%3D%22Toggle%20dark%20mode%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20class%3D%22slider%22%3E%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fheader%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22chat-box%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22welcome-container%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cimg%20src%3D%22drey.png%22%20alt%3D%22AI%20Avatar%22%20class%3D%22avatar%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3EWelcome%20to%20Calyx%20AI%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%3EStart%20a%20new%20conversation%20or%20select%20one%20from%20the%20history.%20Your%20chats%20are%20saved%20automatically.%3C%2Fp%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22example-prompts%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class%3D%22example-prompt%22%3ECreate%20a%20Python%20Flask%20server%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class%3D%22example-prompt%22%3EWrite%20a%20JavaScript%20function%20to%20validate%20an%20email%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class%3D%22example-prompt%22%3EExplain%20recursion%20with%20a%20code%20example%20in%20C%2B%2B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22scroll-to-bottom-btn%22%20title%3D%22Scroll%20to%20bottom%22%20class%3D%22icon-btn%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%22fa-solid%20fa-chevron-down%22%3E%3C%2Fi%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cform%20id%3D%22chat-form%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22input-container%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctextarea%20id%3D%22chat-input%22%20placeholder%3D%22Ask%20me%20anything...%20%22%20required%3E%3C%2Ftextarea%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22form-buttons%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22send-btn%22%20type%3D%22submit%22%20class%3D%22icon-btn%22%20title%3D%22Send%22%20aria-label%3D%22Send%20message%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%22fa-solid%20fa-paper-plane%22%3E%3C%2Fi%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fform%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%0A%20%20%20%20%3C!--%20Settings%20Modal%20--%3E%0A%20%20%20%20%3Cdiv%20id%3D%22settings-modal%22%20class%3D%22modal%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22modal-content%20settings-content%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22close-settings%22%20title%3D%22Close%20settings%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%20class%3D%22fa-solid%20fa-xmark%22%3E%3C%2Fi%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3ESettings%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22settings-section%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%3EAppearance%3C%2Fh3%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22setting%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22font-size-controls%22%3EFont%20Size%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22font-size-controls%22%20style%3D%22display%3A%20flex%3B%20align-items%3A%20center%3B%20gap%3A%205px%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22decrease-font%22%3E%3Ci%20class%3D%22fa-solid%20fa-minus%22%3E%3C%2Fi%3E%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20id%3D%22current-font-size%22%3E16px%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22increase-font%22%3E%3Ci%20class%3D%22fa-solid%20fa-plus%22%3E%3C%2Fi%3E%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22setting%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for%3D%22chat-color-picker%22%3EYour%20Chat%20Color%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22custom-color-picker-wrapper%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22custom-color-preview%22%3E%3Ci%20class%3D%22fa-solid%20fa-eye-dropper%22%3E%3C%2Fi%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22color%22%20id%3D%22chat-color-picker%22%20value%3D%22%230084ff%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22settings-section%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch3%3EProfile%3C%2Fh3%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22setting%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20id%3D%22avatar-upload-label%22%20for%3D%22avatar-upload%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%3EYour%20Avatar%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cimg%20id%3D%22avatar-preview%22%20src%3D%22drey.png%22%20alt%3D%22Your%20avatar%20preview%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Flabel%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22file%22%20id%3D%22avatar-upload%22%20accept%3D%22image%2F*%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22save-settings-btn%22%3ESave%20and%20Close%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22settings-section%22%20style%3D%22border%3A%20none%3B%20padding-top%3A%201rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22logout-btn%22%3ELogout%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%3C!--%20Confirmation%20modal%20for%20chat%20deletion%20--%3E%0A%20%20%20%20%3Cdiv%20id%3D%22confirm-delete-modal%22%20class%3D%22modal%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22modal-content%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3EConfirm%20Deletion%3C%2Fh2%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%20id%3D%22confirm-delete-text%22%3EAre%20you%20sure%20you%20want%20to%20delete%20this%20chat%3F%3C%2Fp%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22modal-actions%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22cancel-delete-btn%22%20class%3D%22modal-btn%20modal-btn-secondary%22%3ECancel%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22confirm-delete-btn%22%20class%3D%22modal-btn%20modal-btn-danger%22%3EDelete%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%3Cscript%3E%0Aeval(atob(%22ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0%2BIHsKICAgICAgICAgICAgLy8gLS0tIFBhcnRpY2xlIEJhY2tncm91bmQgLS0tCiAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXJ0aWNsZS1jYW52YXMnKTsKICAgICAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTZXQgY2FudmFzIHRvIGZ1bGwgc2NyZWVuCiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2l6ZUNhbnZhcygpIHsKICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcmVzaXplQ2FudmFzKCk7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVDYW52YXMpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUGFydGljbGUgc3lzdGVtCiAgICAgICAgICAgIGNvbnN0IHBhcnRpY2xlcyA9IFtdOwogICAgICAgICAgICBjb25zdCBwYXJ0aWNsZUNvdW50ID0gMTAwOwogICAgICAgICAgICBjb25zdCBwYXJ0aWNsZUNvbG9ycyA9IFsnIzAwODRmZicsICcjMDBjNGZmJywgJyMwMDY2Y2MnLCAnIzAwYWFmZiddOwogICAgICAgICAgICAKICAgICAgICAgICAgY2xhc3MgUGFydGljbGUgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gTWF0aC5yYW5kb20oKSAqIGNhbnZhcy53aWR0aDsKICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBNYXRoLnJhbmRvbSgpICogY2FudmFzLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNpemUgPSBNYXRoLnJhbmRvbSgpICogMyArIDE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVlZFggPSBNYXRoLnJhbmRvbSgpICogMSAtIDAuNTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWVkWSA9IE1hdGgucmFuZG9tKCkgKiAxIC0gMC41OwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBwYXJ0aWNsZUNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwYXJ0aWNsZUNvbG9ycy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wYWNpdHkgPSBNYXRoLnJhbmRvbSgpICogMC41ICsgMC4xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB1cGRhdGUoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IHRoaXMuc3BlZWRYOwogICAgICAgICAgICAgICAgICAgIHRoaXMueSArPSB0aGlzLnNwZWVkWTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy54ID4gY2FudmFzLndpZHRoIHx8IHRoaXMueCA8IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVlZFggPSAtdGhpcy5zcGVlZFg7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnkgPiBjYW52YXMuaGVpZ2h0IHx8IHRoaXMueSA8IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVlZFkgPSAtdGhpcy5zcGVlZFk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBkcmF3KCkgewogICAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IHRoaXMub3BhY2l0eTsKICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy5jb2xvcjsKICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyh0aGlzLngsIHRoaXMueSwgdGhpcy5zaXplLCAwLCBNYXRoLlBJICogMik7CiAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGwoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlUGFydGljbGVzKCkgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0aWNsZUNvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXMucHVzaChuZXcgUGFydGljbGUoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIGFuaW1hdGVQYXJ0aWNsZXMoKSB7CiAgICAgICAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRpY2xlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHBhcnRpY2xlc1tpXS51cGRhdGUoKTsKICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXNbaV0uZHJhdygpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIENvbm5lY3QgcGFydGljbGVzCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IGk7IGogPCBwYXJ0aWNsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZHggPSBwYXJ0aWNsZXNbaV0ueCAtIHBhcnRpY2xlc1tqXS54OwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkeSA9IHBhcnRpY2xlc1tpXS55IC0gcGFydGljbGVzW2pdLnk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IDEwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gcGFydGljbGVzW2ldLmNvbG9yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4xICogKDEgLSBkaXN0YW5jZS8xMDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDAuNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8ocGFydGljbGVzW2ldLngsIHBhcnRpY2xlc1tpXS55KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ocGFydGljbGVzW2pdLngsIHBhcnRpY2xlc1tqXS55KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlUGFydGljbGVzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY3JlYXRlUGFydGljbGVzKCk7CiAgICAgICAgICAgIGFuaW1hdGVQYXJ0aWNsZXMoKTsKCiAgICAgICAgICAgIC8vIC0tLSBBdXRoZW50aWNhdGlvbiBMb2dpYyAtLS0KICAgICAgICAgICAgY29uc3QgYXV0aENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdXRoLWNvbnRhaW5lcicpOwogICAgICAgICAgICBjb25zdCBhcHBDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwLWNvbnRhaW5lcicpOwogICAgICAgICAgICBjb25zdCBsb2dpbkZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW4tZm9ybS1lbGVtZW50Jyk7CiAgICAgICAgICAgIGNvbnN0IHJlZ2lzdGVyRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3Rlci1mb3JtLWVsZW1lbnQnKTsKICAgICAgICAgICAgY29uc3QgYXV0aEVycm9yTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdXRoLWVycm9yLW1lc3NhZ2UnKTsKICAgICAgICAgICAgY29uc3QgcmVnaXN0ZXJFcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVnaXN0ZXItZXJyb3ItbWVzc2FnZScpOwogICAgICAgICAgICBjb25zdCBhdXRoTG9hZGluZ092ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXV0aC1sb2FkaW5nLW92ZXJsYXknKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhbHl4X3VzZXJzJykpIHsKICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYWx5eF91c2VycycsIEpTT04uc3RyaW5naWZ5KHt9KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGxldCBjdXJyZW50VXNlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWx5eF9jdXJyZW50VXNlcicpOwoKICAgICAgICAgICAgY29uc3Qgc2hvd0F1dGhFcnJvciA9IChtZXNzYWdlLCBpc0xvZ2luID0gdHJ1ZSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gaXNMb2dpbiA%2FIGF1dGhFcnJvck1lc3NhZ2UgOiByZWdpc3RlckVycm9yTWVzc2FnZTsKICAgICAgICAgICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7CiAgICAgICAgICAgICAgICBlcnJvckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpLCAzMDAwKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IGhpZGVBdXRoRXJyb3JzID0gKCkgPT4gewogICAgICAgICAgICAgICAgYXV0aEVycm9yTWVzc2FnZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJFcnJvck1lc3NhZ2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IHRyYW5zaXRpb25Ub0FwcCA9ICgpID0%2BIHsKICAgICAgICAgICAgICAgIGF1dGhMb2FkaW5nT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgYXV0aENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGFwcENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVDaGF0QXBwKCk7CiAgICAgICAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IHRvZ2dsZUF1dGhGb3JtcyA9IChhY3Rpb24pID0%2BIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxvZ2luQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWZvcm0nKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlZ2lzdGVyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZ2lzdGVyLWZvcm0nKTsKICAgICAgICAgICAgICAgIGhpZGVBdXRoRXJyb3JzKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdzaG93UmVnaXN0ZXInKSB7CiAgICAgICAgICAgICAgICAgICAgbG9naW5Db250YWluZXIuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJGb3JtLnJlc2V0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgICAgICAgICAgICAgIGxvZ2luQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgICAgICAgICAgICAgICAgIGxvZ2luRm9ybS5yZXNldCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2VyKSB7CiAgICAgICAgICAgICAgICBhdXRoQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBhcHBDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgICAgIGluaXRpYWxpemVDaGF0QXBwKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhdXRoQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgYXBwQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBlLnRhcmdldC5kYXRhc2V0LmF1dGhBY3Rpb247CiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uKSB0b2dnbGVBdXRoRm9ybXMoYWN0aW9uKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBsb2dpbkZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0%2BIHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGhpZGVBdXRoRXJyb3JzKCk7CiAgICAgICAgICAgICAgICBjb25zdCBlbWFpbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbi1lbWFpbCcpLnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgICAgIGNvbnN0IHBhc3N3b3JkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLXBhc3N3b3JkJykudmFsdWUudHJpbSgpOwogICAgICAgICAgICAgICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQpIHsKICAgICAgICAgICAgICAgICAgICBzaG93QXV0aEVycm9yKCdQbGVhc2UgZmlsbCBpbiBhbGwgZmllbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VycyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhbHl4X3VzZXJzJykpOwogICAgICAgICAgICAgICAgICAgIGlmICghdXNlcnNbZW1haWxdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBdXRoRXJyb3IoJ05vIGFjY291bnQgZm91bmQgd2l0aCB0aGlzIGVtYWlsJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJzW2VtYWlsXS5wYXNzd29yZCAhPT0gcGFzc3dvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0F1dGhFcnJvcignSW5jb3JyZWN0IHBhc3N3b3JkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSBlbWFpbDsKICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FseXhfY3VycmVudFVzZXInLCBlbWFpbCk7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvQXBwKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGVycm9yOicsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICBzaG93QXV0aEVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgbG9naW4nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZWdpc3RlckZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0%2BIHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGhpZGVBdXRoRXJyb3JzKCk7CiAgICAgICAgICAgICAgICBjb25zdCB1c2VybmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3Rlci11c2VybmFtZScpLnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgICAgIGNvbnN0IGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZ2lzdGVyLWVtYWlsJykudmFsdWUudHJpbSgpOwogICAgICAgICAgICAgICAgY29uc3QgcGFzc3dvcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVnaXN0ZXItcGFzc3dvcmQnKS52YWx1ZS50cmltKCk7CiAgICAgICAgICAgICAgICBpZiAoIXVzZXJuYW1lIHx8ICFlbWFpbCB8fCAhcGFzc3dvcmQpIHsKICAgICAgICAgICAgICAgICAgICBzaG93QXV0aEVycm9yKCdBbGwgZmllbGRzIGFyZSByZXF1aXJlZCcsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocGFzc3dvcmQubGVuZ3RoIDwgNikgewogICAgICAgICAgICAgICAgICAgIHNob3dBdXRoRXJyb3IoJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzJywgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlcnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWx5eF91c2VycycpKTsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlcnNbZW1haWxdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBdXRoRXJyb3IoJ0FuIGFjY291bnQgd2l0aCB0aGlzIGVtYWlsIGFscmVhZHkgZXhpc3RzJywgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHVzZXJzW2VtYWlsXSA9IHsgdXNlcm5hbWUsIHBhc3N3b3JkLCBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9OwogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYWx5eF91c2VycycsIEpTT04uc3RyaW5naWZ5KHVzZXJzKSk7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSBlbWFpbDsKICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FseXhfY3VycmVudFVzZXInLCBlbWFpbCk7CiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJFcnJvck1lc3NhZ2UudGV4dENvbnRlbnQgPSAnQWNjb3VudCBjcmVhdGVkIHN1Y2Nlc3NmdWxseSEnOwogICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyRXJyb3JNZXNzYWdlLnN0eWxlLmNvbG9yID0gJyMyOGE3NDUnOwogICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyRXJyb3JNZXNzYWdlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZWdpc3RlckVycm9yTWVzc2FnZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uVG9BcHAoKTsKICAgICAgICAgICAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVnaXN0cmF0aW9uIGVycm9yOicsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICBzaG93QXV0aEVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgcmVnaXN0cmF0aW9uJywgZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gLS0tIEVORCBvZiBBdXRoZW50aWNhdGlvbiBMb2dpYyAtLS0KCiAgICAgICAgICAgIC8vIC0tLSBDaGF0IEFwcCBMb2dpYyAod3JhcHBlZCBpbiBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBhZnRlciBsb2dpbikgLS0tCiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVDaGF0QXBwKCkgewogICAgICAgICAgICAgICAgY29uc3Qgc2V0VmggPSAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXZoJywgYCR7d2luZG93LmlubmVySGVpZ2h0ICogMC4wMX1weGApOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBzZXRWaCk7CiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb3JpZW50YXRpb25jaGFuZ2UnLCBzZXRWaCk7CiAgICAgICAgICAgICAgICBzZXRWaCgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBjaGF0Qm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXQtYm94Jyk7CiAgICAgICAgICAgICAgICBjb25zdCBjaGF0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0LWZvcm0nKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0LWlucHV0Jyk7CiAgICAgICAgICAgICAgICBjb25zdCBzZW5kQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbmQtYnRuJyk7CiAgICAgICAgICAgICAgICBjb25zdCB0aGVtZUNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lLWNoZWNrYm94Jyk7CiAgICAgICAgICAgICAgICBjb25zdCB3ZWxjb21lQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dlbGNvbWUtY29udGFpbmVyJyk7CiAgICAgICAgICAgICAgICBjb25zdCBub3RpZmljYXRpb25CYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90aWZpY2F0aW9uLWJhcicpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCBzY3JvbGxUb0JvdHRvbUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JvbGwtdG8tYm90dG9tLWJ0bicpOwogICAgICAgICAgICAgICAgY29uc3QgdG9nZ2xlU2lkZWJhckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtc2lkZWJhci1idG4nKTsKICAgICAgICAgICAgICAgIGNvbnN0IHNpZGViYXJPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZGViYXItb3ZlcmxheScpOwogICAgICAgICAgICAgICAgY29uc3QgbmV3Q2hhdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctY2hhdC1idG4nKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXQtbGlzdCcpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLWJ0bicpOwogICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3NNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncy1tb2RhbCcpOwogICAgICAgICAgICAgICAgY29uc3QgY2xvc2VTZXR0aW5nc0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZS1zZXR0aW5ncycpOwogICAgICAgICAgICAgICAgY29uc3Qgc2F2ZVNldHRpbmdzQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmUtc2V0dGluZ3MtYnRuJyk7CiAgICAgICAgICAgICAgICBjb25zdCBkZWNyZWFzZUZvbnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVjcmVhc2UtZm9udCcpOwogICAgICAgICAgICAgICAgY29uc3QgaW5jcmVhc2VGb250QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luY3JlYXNlLWZvbnQnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGb250U2l6ZVNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudC1mb250LXNpemUnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRDb2xvclBpY2tlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0LWNvbG9yLXBpY2tlcicpOwogICAgICAgICAgICAgICAgY29uc3QgYXZhdGFyVXBsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YXRhci11cGxvYWQnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGF2YXRhclByZXZpZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhdGFyLXByZXZpZXcnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbUNvbG9yUHJldmlldyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b20tY29sb3ItcHJldmlldycpOwogICAgICAgICAgICAgICAgY29uc3QgbG9nb3V0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ291dC1idG4nKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgY29uZmlybURlbGV0ZU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbmZpcm0tZGVsZXRlLW1vZGFsJyk7CiAgICAgICAgICAgICAgICBjb25zdCBjb25maXJtRGVsZXRlVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25maXJtLWRlbGV0ZS10ZXh0Jyk7CiAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxEZWxldGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsLWRlbGV0ZS1idG4nKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1EZWxldGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uZmlybS1kZWxldGUtYnRuJyk7CgogICAgICAgICAgICAgICAgY29uc3QgQVBJX0JBU0VfVVJMID0gJ2h0dHBzOi8vYXBpLmRyZWFkZWQuc2l0ZS9hcGkvY2hhdGdwdCc7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCBhbGxDaGF0cyA9IHt9OwogICAgICAgICAgICAgICAgbGV0IGFjdGl2ZUNoYXRJZCA9IG51bGw7CiAgICAgICAgICAgICAgICBsZXQgY2hhdElkVG9EZWxldGUgPSBudWxsOyAKICAgICAgICAgICAgICAgIGxldCBzZXR0aW5ncyA9IHsgZm9udFNpemU6IDE2LCB1c2VyQ2hhdENvbG9yOiAnIzAwODRmZicsIHVzZXJBdmF0YXI6ICdkcmV5LnBuZycgfTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gVXNlci1zcGVjaWZpYyBrZXlzIGZvciBsb2NhbFN0b3JhZ2UKICAgICAgICAgICAgICAgIGNvbnN0IFRIRU1FX0tFWSA9IGBjYWx5eF90aGVtZV8ke2N1cnJlbnRVc2VyfWA7CiAgICAgICAgICAgICAgICBjb25zdCBDSEFUU19LRVkgPSBgY2FseXhfY2hhdHNfJHtjdXJyZW50VXNlcn1gOwogICAgICAgICAgICAgICAgY29uc3QgQUNUSVZFX0NIQVRfS0VZID0gYGNhbHl4X2FjdGl2ZV9jaGF0XyR7Y3VycmVudFVzZXJ9YDsKICAgICAgICAgICAgICAgIGNvbnN0IFNFVFRJTkdTX0tFWSA9IGBjYWx5eF9zZXR0aW5nc18ke2N1cnJlbnRVc2VyfWA7CgogICAgICAgICAgICAgICAgbG9hZFRoZW1lKCk7CiAgICAgICAgICAgICAgICBsb2FkU2V0dGluZ3MoKTsKICAgICAgICAgICAgICAgIGFwcGx5U2V0dGluZ3MoKTsKICAgICAgICAgICAgICAgIGxvYWRBbGxDaGF0cygpOwogICAgICAgICAgICAgICAgaGFuZGxlU2VuZEJ1dHRvblN0YXRlKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNoYXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZVNlbmRNZXNzYWdlKTsKICAgICAgICAgICAgICAgIGNoYXRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0%2BIHsKICAgICAgICAgICAgICAgICAgICBhdXRvUmVzaXplSW5wdXQoKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTZW5kQnV0dG9uU3RhdGUoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhlbWVDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0b2dnbGVUaGVtZSk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZURvY3VtZW50Q2xpY2spOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0b2dnbGVTaWRlYmFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdzaWRlYmFyLW9wZW4nKSk7CiAgICAgICAgICAgICAgICBzaWRlYmFyT3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0%2BIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnc2lkZWJhci1vcGVuJykpOwogICAgICAgICAgICAgICAgbmV3Q2hhdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZU5ld0NoYXQpOwogICAgICAgICAgICAgICAgY2hhdEJveC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBoYW5kbGVDaGF0Qm94U2Nyb2xsKTsKICAgICAgICAgICAgICAgIHNjcm9sbFRvQm90dG9tQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc21hcnRTY3JvbGxUb0JvdHRvbSk7CgogICAgICAgICAgICAgICAgc2V0dGluZ3NCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzZXR0aW5nc01vZGFsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCcpOwogICAgICAgICAgICAgICAgY2xvc2VTZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0%2BIHNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7CiAgICAgICAgICAgICAgICBzZXR0aW5nc01vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7IGlmIChlLnRhcmdldCA9PT0gc2V0dGluZ3NNb2RhbCkgc2V0dGluZ3NNb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyB9KTsKICAgICAgICAgICAgICAgIHNhdmVTZXR0aW5nc0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVBbmRBcHBseVNldHRpbmdzKTsKICAgICAgICAgICAgICAgIGluY3JlYXNlRm9udEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0%2BIHVwZGF0ZUZvbnRTaXplKDEpKTsKICAgICAgICAgICAgICAgIGRlY3JlYXNlRm9udEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0%2BIHVwZGF0ZUZvbnRTaXplKC0xKSk7CiAgICAgICAgICAgICAgICBhdmF0YXJVcGxvYWQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlQXZhdGFyVXBsb2FkKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY2hhdENvbG9yUGlja2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbG9yID0gY2hhdENvbG9yUGlja2VyLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLnVzZXJDaGF0Q29sb3IgPSBuZXdDb2xvcjsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdXNlci1tc2ctYmctY3VzdG9tJywgbmV3Q29sb3IpOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZUN1c3RvbUNvbG9yUHJldmlldyhuZXdDb2xvcik7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9nb3V0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjYWx5eF9jdXJyZW50VXNlcicpOwogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgY2FuY2VsRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBjb25maXJtRGVsZXRlTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgY2hhdElkVG9EZWxldGUgPSBudWxsOyB9KTsKICAgICAgICAgICAgICAgIGNvbmZpcm1EZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXRJZFRvRGVsZXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhbGxDaGF0c1tjaGF0SWRUb0RlbGV0ZV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVDaGF0SWQgPT09IGNoYXRJZFRvRGVsZXRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1haW5pbmdDaGF0SWRzID0gT2JqZWN0LmtleXMoYWxsQ2hhdHMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbmluZ0NoYXRJZHMubGVuZ3RoID4gMCkgeyBzd2l0Y2hDaGF0KHJlbWFpbmluZ0NoYXRJZHNbcmVtYWluaW5nQ2hhdElkcy5sZW5ndGggLSAxXSk7IH0gZWxzZSB7IGNyZWF0ZU5ld0NoYXQoKTsgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVBbGxDaGF0cygpOyByZW5kZXJDaGF0TGlzdCgpOyBzaG93Tm90aWZpY2F0aW9uKCJDaGF0IGRlbGV0ZWQuIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGNoYXRJZFRvRGVsZXRlID0gbnVsbDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7IGlmIChlLnRhcmdldCA9PT0gY29uZmlybURlbGV0ZU1vZGFsKSB7IGNvbmZpcm1EZWxldGVNb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyBjaGF0SWRUb0RlbGV0ZSA9IG51bGw7fSB9KTsKCiAgICAgICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBoYW5kbGVTZW5kTWVzc2FnZShlKSB7CiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlVGV4dCA9IGNoYXRJbnB1dC52YWx1ZS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyTWVzc2FnZVRleHQgfHwgIWFjdGl2ZUNoYXRJZCkgcmV0dXJuOwoKICAgICAgICAgICAgICAgICAgICBzZW5kQnRuLmNsYXNzTGlzdC5hZGQoJ3NlbmQtYnRuLWFuaW1hdGVkJyk7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbmQtYnRuLWFuaW1hdGVkJyksIDUwMCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNGaXJzdE1lc3NhZ2UgPSBhbGxDaGF0c1thY3RpdmVDaGF0SWRdLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZSA9IHsgdGV4dDogdXNlck1lc3NhZ2VUZXh0LCBzZW5kZXI6ICd1c2VyJywgdGltZXN0YW1wOiBnZXRUaW1lc3RhbXAoKSB9OwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlSW5kZXggPSBhZGRNZXNzYWdlVG9DaGF0KHVzZXJNZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCByZW5kZXJNZXNzYWdlKHVzZXJNZXNzYWdlLCB7IG1lc3NhZ2VJbmRleDogdXNlck1lc3NhZ2VJbmRleCB9KTsKICAgICAgICAgICAgICAgICAgICBjaGF0SW5wdXQudmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgICAgICBhdXRvUmVzaXplSW5wdXQoKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTZW5kQnV0dG9uU3RhdGUoKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRmlyc3RNZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gdXNlck1lc3NhZ2VUZXh0LnN1YnN0cmluZygwLCAzMCkgKyAodXNlck1lc3NhZ2VUZXh0Lmxlbmd0aCA%2BIDMwID8gJy4uLicgOiAnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsbENoYXRzW2FjdGl2ZUNoYXRJZF0udGl0bGUgPSB0aXRsZTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQ2hhdExpc3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUFsbENoYXRzKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGdldEFpUmVzcG9uc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2V0QWlSZXNwb25zZSgpIHsKICAgICAgICAgICAgICAgICAgICB0b2dnbGVGb3JtU3RhdGUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgc2hvd0xvYWRpbmdJbmRpY2F0b3IoKTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlQ2hhdCA9IGFsbENoYXRzW2FjdGl2ZUNoYXRJZF07CiAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3RpdmVDaGF0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlRm9ybVN0YXRlKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IGFjdGl2ZUNoYXQubWVzc2FnZXNbYWN0aXZlQ2hhdC5tZXNzYWdlcy5sZW5ndGggLSAxXTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWxhc3RNZXNzYWdlIHx8IGxhc3RNZXNzYWdlLnNlbmRlciAhPT0gJ3VzZXInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlRm9ybVN0YXRlKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRleHQgPSBsYXN0TWVzc2FnZS50ZXh0LnJlcGxhY2UoLyhcclxufFxufFxyKS9nbSwgIiAiKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250ZXh0LnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZUZvcm1TdGF0ZShmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFVybCA9IG5ldyBVUkwoQVBJX0JBU0VfVVJMKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0VXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoJ3RleHQnLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJveGllZFVybCA9IGBodHRwczovL2NvcnNwcm94eS5pby8%2FJHt0YXJnZXRVcmwudG9TdHJpbmcoKX1gOwoKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChwcm94aWVkVXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWlNZXNzYWdlOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGA8c3BhbiBjbGFzcz0iZXJyb3ItdGV4dCI%2BQVBJIEVycm9yICgke3Jlc3BvbnNlLnN0YXR1c30pOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9Ljwvc3Bhbj5gOwogICAgICAgICAgICAgICAgICAgICAgICAgICBhaU1lc3NhZ2UgPSB7IHRleHQ6IGVycm9yVGV4dCwgc2VuZGVyOiAnYWknLCBpc0Vycm9yOiB0cnVlLCB0aW1lc3RhbXA6IGdldFRpbWVzdGFtcCgpIH07CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlNZXNzYWdlID0geyB0ZXh0OiBkYXRhPy5yZXN1bHQ%2FLnByb21wdCB8fCAnU29ycnksIEkgcmVjZWl2ZWQgYW4gdW5leHBlY3RlZCByZXNwb25zZS4nLCBzZW5kZXI6ICdhaScsIHRpbWVzdGFtcDogZ2V0VGltZXN0YW1wKCkgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhaU1lc3NhZ2VJbmRleCA9IGFkZE1lc3NhZ2VUb0NoYXQoYWlNZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVuZGVyTWVzc2FnZShhaU1lc3NhZ2UsIHsgbWVzc2FnZUluZGV4OiBhaU1lc3NhZ2VJbmRleCB9KTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHsgdGV4dDogYDxzcGFuIGNsYXNzPSJlcnJvci10ZXh0Ij5Db3VsZCBub3QgZ2V0IGEgcmVzcG9uc2UuIENoZWNrIHlvdXIgbmV0d29yayBjb25uZWN0aW9uLjwvc3Bhbj5gLCBzZW5kZXI6ICdhaScsIGlzRXJyb3I6IHRydWUsIHRpbWVzdGFtcDogZ2V0VGltZXN0YW1wKCkgfTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JJbmRleCA9IGFkZE1lc3NhZ2VUb0NoYXQoZXJyb3JNZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVuZGVyTWVzc2FnZShlcnJvck1lc3NhZ2UsIHsgbWVzc2FnZUluZGV4OiBlcnJvckluZGV4IH0pOwogICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZUZvcm1TdGF0ZShmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFkZE1lc3NhZ2VUb0NoYXQobWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZlQ2hhdElkIHx8ICFhbGxDaGF0c1thY3RpdmVDaGF0SWRdKSByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICAgICAgYWxsQ2hhdHNbYWN0aXZlQ2hhdElkXS5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIHNhdmVBbGxDaGF0cygpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhbGxDaGF0c1thY3RpdmVDaGF0SWRdLm1lc3NhZ2VzLmxlbmd0aCAtIDE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVuZGVyU3RhdGljTWVzc2FnZUNvbnRlbnQobWVzc2FnZSwgZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvZGVCbG9ja1JlZ2V4ID0gL2BgYChcdyopXG4oW1xzXFNdKj8pYGBgL2c7CiAgICAgICAgICAgICAgICAgICAgbGV0IGxhc3RJbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvZGVCbG9ja0luZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2g7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnJzsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKG1hdGNoID0gY29kZUJsb2NrUmVnZXguZXhlYyhtZXNzYWdlLnRleHQpKSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0QmVmb3JlID0gbWVzc2FnZS50ZXh0LnN1YnN0cmluZyhsYXN0SW5kZXgsIG1hdGNoLmluZGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRleHRCZWZvcmUudHJpbSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSkudGV4dENvbnRlbnQgPSB0ZXh0QmVmb3JlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RlID0gbWF0Y2hbMl0udHJpbSgpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBidWlsZENvZGVCbG9jayhjb2RlLCBtZXNzYWdlLCBjb2RlQmxvY2tJbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVCbG9ja0luZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RJbmRleCA9IGNvZGVCbG9ja1JlZ2V4Lmxhc3RJbmRleDsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHRBZnRlciA9IG1lc3NhZ2UudGV4dC5zdWJzdHJpbmcobGFzdEluZGV4KTsKICAgICAgICAgICAgICAgICAgICBpZiAodGV4dEFmdGVyLnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSkudGV4dENvbnRlbnQgPSB0ZXh0QWZ0ZXI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBhc3luYyBmdW5jdGlvbiByZW5kZXJNZXNzYWdlKG1lc3NhZ2UsIG9wdGlvbnMgPSB7fSkgewogICAgICAgICAgICAgICAgICAgIGlmICh3ZWxjb21lQ29udGFpbmVyKSB3ZWxjb21lQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlJywgYCR7bWVzc2FnZS5zZW5kZXJ9LW1lc3NhZ2VgKTsKICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5pc0Vycm9yKSBtZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlcnJvci1tZXNzYWdlJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubWVzc2FnZUluZGV4ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUVsZW1lbnQuZGF0YXNldC5tZXNzYWdlSW5kZXggPSBvcHRpb25zLm1lc3NhZ2VJbmRleDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXZhdGFyU3JjID0gbWVzc2FnZS5zZW5kZXIgPT09ICd1c2VyJyA%2FIHNldHRpbmdzLnVzZXJBdmF0YXIgOiAnZHJleS5wbmcnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG1lc3NhZ2UudGltZXN0YW1wIHx8IGdldFRpbWVzdGFtcCgpOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50SHRtbCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC1jb250ZW50IiBzdHlsZT0id2hpdGUtc3BhY2U6IHByZS13cmFwOyI%2BPC9kaXY%2BCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0aW1lc3RhbXAiPiR7dGltZXN0YW1wfTwvc3Bhbj5gOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VFbGVtZW50LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IiR7YXZhdGFyU3JjfSIgYWx0PSIke21lc3NhZ2Uuc2VuZGVyfSBBdmF0YXIiIGNsYXNzPSJhdmF0YXIiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZXNzYWdlLWNvbnRlbnQiPiR7Y29udGVudEh0bWx9PC9kaXY%2BYDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjaGF0Qm94LmFwcGVuZENoaWxkKG1lc3NhZ2VFbGVtZW50KTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dENvbnRlbnRFbGVtZW50ID0gbWVzc2FnZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnRleHQtY29udGVudCcpOwogICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0Q29udGVudEVsZW1lbnQgJiYgbWVzc2FnZS50ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlLnNlbmRlciA9PT0gJ3VzZXInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudEVsZW1lbnQudGV4dENvbnRlbnQgPSBtZXNzYWdlLnRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2tpcEFuaW1hdGlvbiB8fCBtZXNzYWdlLmlzRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJTdGF0aWNNZXNzYWdlQ29udGVudChtZXNzYWdlLCB0ZXh0Q29udGVudEVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0eXBld3JpdGVyRWZmZWN0KG1lc3NhZ2UsIHRleHRDb250ZW50RWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc21hcnRTY3JvbGxUb0JvdHRvbSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVNlbmRCdXR0b25TdGF0ZSgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2hhdElucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VuZEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gc2F2ZUFsbENoYXRzKCkgeyAKICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShDSEFUU19LRVksIEpTT04uc3RyaW5naWZ5KGFsbENoYXRzKSk7IAogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKEFDVElWRV9DSEFUX0tFWSwgYWN0aXZlQ2hhdElkKTsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsb2FkQWxsQ2hhdHMoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2F2ZWRDaGF0cyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKENIQVRTX0tFWSk7CiAgICAgICAgICAgICAgICAgICAgYWxsQ2hhdHMgPSBzYXZlZENoYXRzID8gSlNPTi5wYXJzZShzYXZlZENoYXRzKSA6IHt9OwogICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNoYXRJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKEFDVElWRV9DSEFUX0tFWSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGFsbENoYXRzKS5sZW5ndGggPT09IDAgfHwgIWFsbENoYXRzW2FjdGl2ZUNoYXRJZF0pIHsgY3JlYXRlTmV3Q2hhdCgpOyB9IGVsc2UgeyBzd2l0Y2hDaGF0KGFjdGl2ZUNoYXRJZCk7IH0KICAgICAgICAgICAgICAgICAgICByZW5kZXJDaGF0TGlzdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY3JlYXRlTmV3Q2hhdCgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdJZCA9IGBjaGF0XyR7RGF0ZS5ub3coKX1gOwogICAgICAgICAgICAgICAgICAgIGFsbENoYXRzW25ld0lkXSA9IHsgaWQ6IG5ld0lkLCB0aXRsZTogIk5ldyBDb252ZXJzYXRpb24iLCBtZXNzYWdlczogW10gfTsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2hDaGF0KG5ld0lkKTsKICAgICAgICAgICAgICAgICAgICBzYXZlQWxsQ2hhdHMoKTsKICAgICAgICAgICAgICAgICAgICByZW5kZXJDaGF0TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnc2lkZWJhci1vcGVuJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBzd2l0Y2hDaGF0KGNoYXRJZCkgewogICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNoYXRJZCA9IGNoYXRJZDsKICAgICAgICAgICAgICAgICAgICBjaGF0Qm94LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUNoYXQgPSBhbGxDaGF0c1thY3RpdmVDaGF0SWRdOwogICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVDaGF0Lm1lc3NhZ2VzLmxlbmd0aCA%2BIDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWN0aXZlQ2hhdC5tZXNzYWdlcy5sZW5ndGg7IGkrKykgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByZW5kZXJNZXNzYWdlKGFjdGl2ZUNoYXQubWVzc2FnZXNbaV0sIHsgc2tpcEFuaW1hdGlvbjogdHJ1ZSwgbWVzc2FnZUluZGV4OiBpIH0pOyAKICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyB3ZWxjb21lQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOyBjaGF0Qm94LmFwcGVuZENoaWxkKHdlbGNvbWVDb250YWluZXIpOyB9CiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQ2hhdExpc3QoKTsKICAgICAgICAgICAgICAgICAgICBzbWFydFNjcm9sbFRvQm90dG9tKCk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdzaWRlYmFyLW9wZW4nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlbGV0ZUNoYXQoY2hhdElkLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICBjaGF0SWRUb0RlbGV0ZSA9IGNoYXRJZDsKICAgICAgICAgICAgICAgICAgICBjb25maXJtRGVsZXRlVGV4dC50ZXh0Q29udGVudCA9IGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlICIke2FsbENoYXRzW2NoYXRJZF0udGl0bGV9Ij8gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHVuZG9uZS5gOwogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVuZGVyQ2hhdExpc3QoKSB7CiAgICAgICAgICAgICAgICAgICAgY2hhdExpc3QuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29ydGVkQ2hhdHMgPSBPYmplY3QudmFsdWVzKGFsbENoYXRzKS5zb3J0KChhLCBiKSA9PiBiLmlkLnNwbGl0KCdfJylbMV0gLSBhLmlkLnNwbGl0KCdfJylbMV0pOwogICAgICAgICAgICAgICAgICAgIHNvcnRlZENoYXRzLmZvckVhY2goY2hhdCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdjaGF0LWxpc3QtaXRlbSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGF0YXNldC5jaGF0SWQgPSBjaGF0LmlkOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhdC5pZCA9PT0gYWN0aXZlQ2hhdElkKSBpdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGA8c3Bhbj4ke2NoYXQudGl0bGV9PC9zcGFuPjxidXR0b24gY2xhc3M9ImRlbGV0ZS1jaGF0LWJ0biIgdGl0bGU9IkRlbGV0ZSBjaGF0Ij48aSBjbGFzcz0iZmEtc29saWQgZmEtdHJhc2gtY2FuIj48L2k%2BPC9idXR0b24%2BYDsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0%2BIHN3aXRjaENoYXQoY2hhdC5pZCkpOwogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy5kZWxldGUtY2hhdC1idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiBkZWxldGVDaGF0KGNoYXQuaWQsIGUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhdExpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFNldHRpbmdzKCkgeyBjb25zdCBzYXZlZFNldHRpbmdzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU0VUVElOR1NfS0VZKTsgaWYgKHNhdmVkU2V0dGluZ3MpIHNldHRpbmdzID0geyAuLi5zZXR0aW5ncywgLi4uSlNPTi5wYXJzZShzYXZlZFNldHRpbmdzKSB9OyB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzYXZlQW5kQXBwbHlTZXR0aW5ncygpIHsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU0VUVElOR1NfS0VZLCBKU09OLnN0cmluZ2lmeShzZXR0aW5ncykpOyBhcHBseVNldHRpbmdzKCk7IHNldHRpbmdzTW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgc2hvd05vdGlmaWNhdGlvbignU2V0dGluZ3Mgc2F2ZWQhJyk7IH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZnVuY3Rpb24gYXBwbHlTZXR0aW5ncygpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tYmFzZS1mb250LXNpemUnLCBgJHtzZXR0aW5ncy5mb250U2l6ZX1weGApOwogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGb250U2l6ZVNwYW4udGV4dENvbnRlbnQgPSBgJHtzZXR0aW5ncy5mb250U2l6ZX1weGA7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXVzZXItbXNnLWJnLWN1c3RvbScsIHNldHRpbmdzLnVzZXJDaGF0Q29sb3IpOwogICAgICAgICAgICAgICAgICAgIGNoYXRDb2xvclBpY2tlci52YWx1ZSA9IHNldHRpbmdzLnVzZXJDaGF0Q29sb3I7CiAgICAgICAgICAgICAgICAgICAgYXZhdGFyUHJldmlldy5zcmMgPSBzZXR0aW5ncy51c2VyQXZhdGFyOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy51c2VyLW1lc3NhZ2UgLmF2YXRhcicpLmZvckVhY2goaW1nID0%2BIGltZy5zcmMgPSBzZXR0aW5ncy51c2VyQXZhdGFyKTsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVDdXN0b21Db2xvclByZXZpZXcoc2V0dGluZ3MudXNlckNoYXRDb2xvcik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ3VzdG9tQ29sb3JQcmV2aWV3KGNvbG9yKSB7CiAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ29sb3JQcmV2aWV3LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGhleCA9IGNvbG9yLnJlcGxhY2UoJyMnLCAnJyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHBhcnNlSW50KGhleC5zdWJzdHJpbmcoMCwgMiksIDE2KTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBnID0gcGFyc2VJbnQoaGV4LnN1YnN0cmluZygyLCA0KSwgMTYpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBwYXJzZUludChoZXguc3Vic3RyaW5nKDQsIDYpLCAxNik7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbHVtaW5hbmNlID0gKDAuMjk5ICogciArIDAuNTg3ICogZyArIDAuMTE0ICogYikgLyAyNTU7CiAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ29sb3JQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoJ2knKS5zdHlsZS5jb2xvciA9IGx1bWluYW5jZSA%2BIDAuNSA%2FICdyZ2JhKDAsMCwwLDAuNyknIDogJ3JnYmEoMjU1LDI1NSwyNTUsMC44KSc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlRm9udFNpemUoY2hhbmdlKSB7IGNvbnN0IG5ld1NpemUgPSBzZXR0aW5ncy5mb250U2l6ZSArIGNoYW5nZTsgaWYgKG5ld1NpemUgPj0gMTIgJiYgbmV3U2l6ZSA8PSAyMCkgeyBzZXR0aW5ncy5mb250U2l6ZSA9IG5ld1NpemU7IGFwcGx5U2V0dGluZ3MoKTsgfSB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVBdmF0YXJVcGxvYWQoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7IGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7IHJlYWRlci5vbmxvYWQgPSAoZSkgPT4geyBzZXR0aW5ncy51c2VyQXZhdGFyID0gZS50YXJnZXQucmVzdWx0OyBhdmF0YXJQcmV2aWV3LnNyYyA9IHNldHRpbmdzLnVzZXJBdmF0YXI7IH07IHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOyB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gc2hvd0xvYWRpbmdJbmRpY2F0b3IoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgbG9hZGluZ0VsZW1lbnQuaWQgPSAnbG9hZGluZy1pbmRpY2F0b3InOyBsb2FkaW5nRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZXNzYWdlJywgJ2FpLW1lc3NhZ2UnKTsKICAgICAgICAgICAgICAgICAgICBsb2FkaW5nRWxlbWVudC5pbm5lckhUTUwgPSBgPGltZyBzcmM9ImRyZXkucG5nIiBhbHQ9IkFJIEF2YXRhciIgY2xhc3M9ImF2YXRhciI%2BPGRpdiBjbGFzcz0ibWVzc2FnZS1jb250ZW50Ij48ZGl2IGNsYXNzPSJsb2FkaW5nLWRvdHMiPjxzcGFuPjwvc3Bhbj48c3Bhbj48L3NwYW4%2BPHNwYW4%2BPC9zcGFuPjwvZGl2PjwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgY2hhdEJveC5hcHBlbmRDaGlsZChsb2FkaW5nRWxlbWVudCk7IHNtYXJ0U2Nyb2xsVG9Cb3R0b20oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZUxvYWRpbmdJbmRpY2F0b3IoKSB7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nLWluZGljYXRvcicpPy5yZW1vdmUoKTsgfQogICAgICAgICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlVGhlbWUoKSB7IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnZGFyay1tb2RlJyk7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRIRU1FX0tFWSwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ2RhcmstbW9kZScpID8gJ2RhcmsnIDogJ2xpZ2h0Jyk7IH0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxvYWRUaGVtZSgpIHsgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRIRU1FX0tFWSkgPT09ICdkYXJrJykgeyBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2RhcmstbW9kZScpOyB0aGVtZUNoZWNrYm94LmNoZWNrZWQgPSB0cnVlOyB9IH0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dOb3RpZmljYXRpb24obWVzc2FnZSwgZHVyYXRpb24gPSAzMDAwKSB7IG5vdGlmaWNhdGlvbkJhci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7IG5vdGlmaWNhdGlvbkJhci5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7IHNldFRpbWVvdXQoKCkgPT4gbm90aWZpY2F0aW9uQmFyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKSwgZHVyYXRpb24pOyB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVGb3JtU3RhdGUoZGlzYWJsZWQpIHsgY2hhdElucHV0LmRpc2FibGVkID0gZGlzYWJsZWQ7IHNlbmRCdG4uZGlzYWJsZWQgPSBkaXNhYmxlZDsgY2hhdElucHV0LnBsYWNlaG9sZGVyID0gZGlzYWJsZWQgPyAiUGxlYXNlIHdhaXQuLi4iIDogIkFzayBtZSBhbnl0aGluZy4uLiI7IH0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGF1dG9SZXNpemVJbnB1dCgpIHsgY2hhdElucHV0LnN0eWxlLmhlaWdodCA9ICdhdXRvJzsgY2hhdElucHV0LnN0eWxlLmhlaWdodCA9IGAke2NoYXRJbnB1dC5zY3JvbGxIZWlnaHR9cHhgOyB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoKSB7IHJldHVybiBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZyhbXSwgeyBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnIH0pOyB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzbWFydFNjcm9sbFRvQm90dG9tKCkgeyBjaGF0Qm94LnNjcm9sbFRvcCA9IGNoYXRCb3guc2Nyb2xsSGVpZ2h0OyB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVDaGF0Qm94U2Nyb2xsKCkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzU2Nyb2xsZWRVcCA9IGNoYXRCb3guc2Nyb2xsSGVpZ2h0IC0gY2hhdEJveC5zY3JvbGxUb3AgPiBjaGF0Qm94LmNsaWVudEhlaWdodCArIDE1MDsKICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb0JvdHRvbUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdzaG93JywgaXNTY3JvbGxlZFVwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRG9jdW1lbnRDbGljayhlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29weUJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5jb3B5LWNvZGUtYnRuJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvcHlCdG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZUJsb2NrID0gY29weUJ0bi5jbG9zZXN0KCcuY29kZS1ibG9jay1jb250YWluZXInKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZSA9IGNvZGVCbG9jay5xdWVyeVNlbGVjdG9yKCdjb2RlJykuaW5uZXJUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb2RlKS50aGVuKCgpID0%2BIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcHlCdG4udGV4dENvbnRlbnQgPSAnQ29waWVkISc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3B5QnRuLmNsYXNzTGlzdC5hZGQoJ2NvcGllZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGNvcHlCdG4udGV4dENvbnRlbnQgPSAnQ29weSc7IGNvcHlCdG4uY2xhc3NMaXN0LnJlbW92ZSgnY29waWVkJyk7IH0sIDIwMDApOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhYkJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5jb2RlLXRhYi1idG4nKTsKICAgICAgICAgICAgICAgICAgICBpZiAodGFiQnRuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRhYkJ0bi5jbG9zZXN0KCcuY29kZS1ibG9jay1jb250YWluZXInKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJlID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3ByZScpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpZnJhbWUgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignaWZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0YWJCdG4uZGF0YXNldC52aWV3OwoKICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb2RlLXRhYi1idG4nKS5mb3JFYWNoKGJ0biA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgICAgICAgICB0YWJCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldyA9PT0gJ3ByZXZpZXcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RlVG9QcmV2aWV3ID0gcHJlLnF1ZXJ5U2VsZWN0b3IoJ2NvZGUnKS5pbm5lclRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZnJhbWUuc3JjZG9jID0gY29kZVRvUHJldmlldzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFbCA9IHRhYkJ0bi5jbG9zZXN0KCcubWVzc2FnZScpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlSW5kZXggPSBwYXJzZUludChtZXNzYWdlRWwuZGF0YXNldC5tZXNzYWdlSW5kZXgsIDEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZUJsb2Nrc0luTWVzc2FnZSA9IEFycmF5LmZyb20obWVzc2FnZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb2RlLWJsb2NrLWNvbnRhaW5lcicpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZUJsb2NrSW5kZXggPSBjb2RlQmxvY2tzSW5NZXNzYWdlLmluZGV4T2YoY29udGFpbmVyKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlSW5kZXggPj0gMCAmJiBjb2RlQmxvY2tJbmRleCA%2BPSAwICYmIGFsbENoYXRzW2FjdGl2ZUNoYXRJZF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhbGxDaGF0c1thY3RpdmVDaGF0SWRdLm1lc3NhZ2VzW21lc3NhZ2VJbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlLmNvZGVCbG9ja1N0YXRlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLmNvZGVCbG9ja1N0YXRlcyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLmNvZGVCbG9ja1N0YXRlc1tjb2RlQmxvY2tJbmRleF0gPSB2aWV3OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVBbGxDaGF0cygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2V4YW1wbGUtcHJvbXB0JykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhdElucHV0LnZhbHVlID0gZS50YXJnZXQudGV4dENvbnRlbnQ7IAogICAgICAgICAgICAgICAgICAgICAgICBhdXRvUmVzaXplSW5wdXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlU2VuZEJ1dHRvblN0YXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXRJbnB1dC5mb2N1cygpOyAKICAgICAgICAgICAgICAgICAgICAgICAgY2hhdEZvcm0uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N1Ym1pdCcsIHsgYnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZSB9KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBidWlsZENvZGVCbG9jayhjb2RlLCBtZXNzYWdlLCBjb2RlQmxvY2tJbmRleCkgewogICAgICAgICAgICAgICAgICAgICBjb25zdCBzYXZlZFN0YXRlID0gbWVzc2FnZS5jb2RlQmxvY2tTdGF0ZXM%2FLltjb2RlQmxvY2tJbmRleF0gfHwgJ2NvZGUnOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ2NvZGUtYmxvY2stY29udGFpbmVyJzsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKTsKICAgICAgICAgICAgICAgICAgICBoZWFkZXIuY2xhc3NOYW1lID0gJ2NvZGUtYmxvY2staGVhZGVyJzsKICAgICAgICAgICAgICAgICAgICBoZWFkZXIuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb2RlLXRhYi1idG4gJHtzYXZlZFN0YXRlID09PSAnY29kZScgPyAnYWN0aXZlJyA6ICcnfSIgZGF0YS12aWV3PSJjb2RlIj5WaWV3IENvZGU8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY29kZS10YWItYnRuICR7c2F2ZWRTdGF0ZSA9PT0gJ3ByZXZpZXcnID8gJ2FjdGl2ZScgOiAnJ30iIGRhdGEtdmlldz0icHJldmlldyI%2BUHJldmlldzwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjb3B5LWNvZGUtYnRuIj5Db3B5PC9idXR0b24%2BCiAgICAgICAgICAgICAgICAgICAgYDsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSk7CiAgICAgICAgICAgICAgICAgICAgY29udGVudC5jbGFzc05hbWUgPSAnY29kZS1ibG9jay1jb250ZW50JzsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJlID0gY29udGVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwcmUnKSk7CiAgICAgICAgICAgICAgICAgICAgcHJlLnN0eWxlLmRpc3BsYXkgPSBzYXZlZFN0YXRlID09PSAnY29kZScgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIHByZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjb2RlJykpLnRleHRDb250ZW50ID0gY29kZTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWZyYW1lID0gY29udGVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKSk7CiAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSBzYXZlZFN0YXRlID09PSAncHJldmlldycgPyAnYmxvY2snIDogJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGlmIChzYXZlZFN0YXRlID09PSAncHJldmlldycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnNyY2RvYyA9IGNvZGU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gdHlwZXdyaXRlckVmZmVjdChtZXNzYWdlLCBlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29kZUJsb2NrUmVnZXggPSAvYGBgKFx3KilcbihbXHNcU10qPylgYGAvZzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IG1lc3NhZ2UudGV4dC5zcGxpdChjb2RlQmxvY2tSZWdleCk7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnJzsKCiAgICAgICAgICAgICAgICAgICAgbGV0IGNvZGVCbG9ja0luZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnQgPT09IHVuZGVmaW5lZCkgY29udGludWU7CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NvZGVDb250ZW50ID0gKGkgJSAzID09PSAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvZGVDb250ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RlID0gcGFydC50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBidWlsZENvZGVCbG9jayhjb2RlLCBtZXNzYWdlLCBjb2RlQmxvY2tJbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0eXBlQ2hhckJ5Q2hhcihjb2RlLCBjb250YWluZXIucXVlcnlTZWxlY3RvcignY29kZScpLCA1KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVCbG9ja0luZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1RleHQgPSAoaSAlIDMgPT09IDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzVGV4dCAmJiBwYXJ0LnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdHlwZUNoYXJCeUNoYXIocGFydCwgc3BhbiwgMjApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNtYXJ0U2Nyb2xsVG9Cb3R0b20oKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0eXBlQ2hhckJ5Q2hhcih0ZXh0LCBlbGVtZW50LCBzcGVlZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0%2BIHsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9ICcnOyAKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAwOyAKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdHlwZSgpIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHRleHQubGVuZ3RoKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgKz0gdGV4dC5jaGFyQXQoaSsrKTsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc21hcnRTY3JvbGxUb0JvdHRvbSgpOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHR5cGUsIHNwZWVkKTsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSgpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IC8vIEVuZCBvZiBpbml0aWFsaXplQ2hhdEFwcAogICAgICAgIH0pOw%3D%3D%22))%3B%0A%20%20%20%20%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E'));</script>